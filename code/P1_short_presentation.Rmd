---
title: "Group 1 - (e)mission impossible"
output:
  beamer_presentation:
    slide_level: 2
    colortheme: "default"
    # fonttheme: "structurebold"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(dev = 'png')
library(tidyverse)
```

## Status quo

\begin{itemize}
    \item Data \checkmark
    \item Model OLS \checkmark
    \item Model GWR \checkmark (some puzzling results)
\end{itemize}

## ToDos

\begin{itemize}
    \item Robustness checks: spatial tests (Moran's I) - what W matrix, vary number of neighbours 
    -> very different to US (more homogeneous to EU), if we'd include Queen's structure we have within-country, 
    inverse distance we have across whole EU (bigger W matrix),  
    so we have distance (Toblers Law), but also country-level legislation, so try a few and not just
    so trying global Moran I across whole space? kinda makes little sense for GWR but well
    we can also try LISAs
    or increase bandwidth in W matrix
    try to mimic what the W matrix bandwidth tries to do (queen nothing to do with distance bands)
    so there is a reason why Videras is short on that
    \item Extension 1: variability over time? (maybe consider only specific region, data availability)
    we could try GWR panel estimation, we can but should not really include FEs, REs will be a pain
    so we could try a subsample (different samples entail different mechanisms) and try and check what's going on
    \item (Extension 2: add other greenhouse gases?)
    \item Preparation of slides for final presentation 
    in general: he knows we can code, but the main point is now that we present it to a scientific community
    -> presentation on scientific progress
    \item Paper $\rightarrow$ any specific requirements? (theory?, literature review?)
\end{itemize}

## Specific questions

\begin{enumerate}
  \item Is the selection of regions OK? (see plot on next slide)
  \item Median $GDP/cap$ coef negative and $(GDP/cap)^2$ positive? Have we reached the Kutznetz turning point already? (median turning point at $0.0001$€, OLS point at $28800$€ (median and mean gdppc below that) - driven by outliers?)
  interpretation: calculate individually for each of the n models and then take the median of that!!!
  \item Density positive vs Videras negative?
  \item Inference of coefficients in GWR model
  what people of ten do: check significance in global estimates and then make var selection based on that
  care: we have some outliers, we should check our residuals, we could either exclude it (brutal) or use the surrounding average value
  ideal solution: heterogeneous errors in the GWR
\end{enumerate}

## Output of our GWR

\tiny
```{r, echo = F}
gwr
```

## GDP/capita

```{r, fig.align='center', fig.cap='Elasticity of emissions with respect to GDP/capita', out.width='99%'} 

# source("code/07_model_GWR.R")

ggplot(data = data_coef) +
  geom_sf(data = shape_nuts1_agg, fill="white") +
  # geom_sf(aes(fill = log.gdppc.), color = "white", lwd = 0) +
  geom_sf(aes(fill = log.gdppc.), color = NA) +
  scale_fill_viridis_c(option = "magma", direction = -1) +
  theme(legend.title = element_blank()) +
  geom_sf(data=shape_nuts1_agg, color='#000000', fill=NA, size=0.1)
```

## Significance Level

```{r, fig.align='center', fig.cap='Significance level of coef on GDP/capita', out.width='99%'} 

# source("code/07_model_GWR.R")

ggplot(data = data_coef) +
  geom_sf(data = shape_nuts1_agg, fill="white") +
  geom_sf(aes(fill = log.gdppc._p_sig), color = NA) + 
  scale_fill_manual(values = rev(magma(4)[2:4])) +
  theme(legend.title = element_blank()) +
  geom_sf(data=shape_nuts1_agg, color='#000000', fill=NA, size=0.1)
```


